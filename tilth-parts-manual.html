<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TILTH Parts Manual — Practitioner Assembly Reference</title>
    <style>
        /* IH/JD Parts Manual format: exploded views, numbered callouts, dense spec lists */
        @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600;700&family=Inter:wght@300;400;600;700&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background: #e8e6da;
            font-family: 'Inter', -apple-system, sans-serif;
            font-size: 9pt;
            line-height: 1.4;
            color: #000;
        }
        
        .manual-page {
            width: 650px;
            margin: 25px auto;
            background: #fff;
            border: 1px solid #000;
            box-shadow: 2px 2px 8px rgba(0,0,0,0.15);
            page-break-inside: avoid;
        }
        
        /* Manual header (parts catalog style) */
        .manual-header {
            background: #000;
            color: #fff;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 3px solid #000;
        }
        
        .manual-title {
            font-weight: 700;
            font-size: 11pt;
            letter-spacing: 0.05em;
        }
        
        .page-number {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 10pt;
            font-weight: 700;
        }
        
        /* Part identification block */
        .part-id-block {
            padding: 16px 20px;
            background: #f5f5f5;
            border-bottom: 2px solid #000;
        }
        
        .part-number {
            font-family: 'IBM Plex Mono', monospace;
            font-weight: 700;
            font-size: 12pt;
            margin-bottom: 6px;
        }
        
        .part-desc {
            font-size: 10pt;
            line-height: 1.5;
            margin-bottom: 4px;
        }
        
        .part-desc strong {
            text-transform: uppercase;
            font-size: 8pt;
            letter-spacing: 0.05em;
        }
        
        /* Assembly diagram with numbered callouts */
        .assembly-diagram {
            padding: 20px;
            background: #fafafa;
            border-bottom: 1px solid #ccc;
            text-align: center;
        }
        
        .diagram-title {
            font-weight: 700;
            font-size: 8pt;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 12px;
            text-align: center;
        }
        
        /* Parts list (numbered components) */
        .parts-list {
            padding: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .list-section {
            font-size: 8pt;
        }
        
        .section-title {
            font-weight: 700;
            font-size: 9pt;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 10px;
            padding-bottom: 4px;
            border-bottom: 2px solid #000;
        }
        
        .part-item {
            display: grid;
            grid-template-columns: 30px 1fr 50px;
            gap: 8px;
            padding: 4px 0;
            border-bottom: 1px dotted #ddd;
            align-items: baseline;
        }
        
        .item-num {
            font-family: 'IBM Plex Mono', monospace;
            font-weight: 700;
            font-size: 8pt;
        }
        
        .item-name {
            font-size: 8pt;
            text-transform: uppercase;
        }
        
        .item-spec {
            font-family: 'IBM Plex Mono', monospace;
            font-weight: 700;
            font-size: 8pt;
            text-align: right;
        }
        
        /* Specification table */
        .spec-table {
            padding: 20px;
            background: #fafafa;
            border-top: 1px solid #ccc;
        }
        
        .spec-title {
            font-weight: 700;
            font-size: 9pt;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 10px;
        }
        
        .spec-row {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
            font-size: 8pt;
            border-bottom: 1px dotted #ddd;
        }
        
        .spec-label {
            text-transform: uppercase;
            font-size: 7pt;
            letter-spacing: 0.03em;
        }
        
        .spec-value {
            font-family: 'IBM Plex Mono', monospace;
            font-weight: 700;
        }
        
        /* Footer reference */
        .manual-footer {
            padding: 10px 20px;
            background: #f5f5f5;
            border-top: 1px solid #000;
            font-size: 7pt;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }
        
        @media print {
            body { background: #fff; }
            .manual-page {
                width: 8.5in;
                margin: 0;
                box-shadow: none;
            }
        }
    </style>
</head>
<body>
    <div id="manualContainer"></div>
    
    <script src="character-profiles.js"></script>
    <script>
        function createAssemblyDiagram(metrics) {
            const size = 240;
            const center = size / 2;
            const radius = size * 0.35;
            const numAxes = 11;
            
            const axisLabels = [
                '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11'
            ];
            
            const metricsArray = [
                metrics.openness, metrics.conscientiousness, metrics.extraversion,
                metrics.agreeableness, metrics.neuroticism, metrics.logic,
                metrics.empathy, metrics.authority, metrics.risk,
                metrics.uncertainty, metrics.decisiveness
            ];
            
            const points = metricsArray.map((value, i) => {
                const angle = (Math.PI * 2 * i) / numAxes - Math.PI / 2;
                const r = (value / 5) * radius;
                const x = center + r * Math.cos(angle);
                const y = center + r * Math.sin(angle);
                return `${x},${y}`;
            }).join(' ');
            
            const callouts = axisLabels.map((label, i) => {
                const angle = (Math.PI * 2 * i) / numAxes - Math.PI / 2;
                const r = (metricsArray[i] / 5) * radius;
                const x = center + r * Math.cos(angle);
                const y = center + r * Math.sin(angle);
                const calloutR = radius * 1.25;
                const calloutX = center + calloutR * Math.cos(angle);
                const calloutY = center + calloutR * Math.sin(angle);
                
                // Leader line from point to callout
                return `
                    <line x1="${x}" y1="${y}" x2="${calloutX}" y2="${calloutY}" 
                          stroke="#000" stroke-width="0.5" stroke-dasharray="2,2"/>
                    <circle cx="${calloutX}" cy="${calloutY}" r="8" 
                            fill="#fff" stroke="#000" stroke-width="1.5"/>
                    <text x="${calloutX}" y="${calloutY}" 
                          fill="#000" 
                          font-size="9" 
                          font-weight="700"
                          font-family="IBM Plex Mono, monospace"
                          text-anchor="middle" 
                          dominant-baseline="middle">
                        ${label}
                    </text>
                `;
            }).join('');
            
            const axes = Array.from({length: numAxes}, (_, i) => {
                const angle = (Math.PI * 2 * i) / numAxes - Math.PI / 2;
                const x2 = center + radius * Math.cos(angle);
                const y2 = center + radius * Math.sin(angle);
                return `<line x1="${center}" y1="${center}" x2="${x2}" y2="${y2}" 
                              stroke="#ccc" stroke-width="0.5"/>`;
            }).join('');
            
            const circles = [1, 2, 3, 4, 5].map(scale => {
                const r = (scale / 5) * radius;
                return `<circle cx="${center}" cy="${center}" r="${r}" 
                                fill="none" stroke="#e0e0e0" stroke-width="0.5"/>`;
            }).join('');
            
            return `
                <svg viewBox="0 0 ${size} ${size}" xmlns="http://www.w3.org/2000/svg" style="width: 100%; max-width: 300px; height: auto;">
                    ${circles}
                    ${axes}
                    <polygon points="${points}" 
                             fill="none" 
                             stroke="#000" 
                             stroke-width="2.5"/>
                    ${metricsArray.map((value, i) => {
                        const angle = (Math.PI * 2 * i) / numAxes - Math.PI / 2;
                        const r = (value / 5) * radius;
                        const x = center + r * Math.cos(angle);
                        const y = center + r * Math.sin(angle);
                        return `<circle cx="${x}" cy="${y}" r="4" fill="#000"/>`;
                    }).join('')}
                    ${callouts}
                </svg>
            `;
        }
        
        function renderPartsManual(character) {
            const partNum = `PRAC-${String(character.episode).padStart(3, '0')}-2048`;
            
            return `
                <div class="manual-page">
                    <div class="manual-header">
                        <div class="manual-title">TILTH PRACTITIONER PARTS MANUAL</div>
                        <div class="page-number">P-${character.episode}</div>
                    </div>
                    
                    <div class="part-id-block">
                        <div class="part-number">${partNum}</div>
                        <div class="part-desc"><strong>Name:</strong> ${character.name}</div>
                        <div class="part-desc"><strong>Configuration:</strong> ${character.identity_archetype}</div>
                        <div class="part-desc"><strong>Station:</strong> ${character.role} — ${character.app}</div>
                    </div>
                    
                    <div class="assembly-diagram">
                        <div class="diagram-title">Fig. ${character.episode} — 11-Component Assembly Profile</div>
                        ${createAssemblyDiagram(character.radar_metrics)}
                    </div>
                    
                    <div class="parts-list">
                        <div class="list-section">
                            <div class="section-title">Components 1–6</div>
                            <div class="part-item">
                                <div class="item-num">1</div>
                                <div class="item-name">Openness</div>
                                <div class="item-spec">${character.radar_metrics.openness}/5</div>
                            </div>
                            <div class="part-item">
                                <div class="item-num">2</div>
                                <div class="item-name">Conscientiousness</div>
                                <div class="item-spec">${character.radar_metrics.conscientiousness}/5</div>
                            </div>
                            <div class="part-item">
                                <div class="item-num">3</div>
                                <div class="item-name">Extraversion</div>
                                <div class="item-spec">${character.radar_metrics.extraversion}/5</div>
                            </div>
                            <div class="part-item">
                                <div class="item-num">4</div>
                                <div class="item-name">Agreeableness</div>
                                <div class="item-spec">${character.radar_metrics.agreeableness}/5</div>
                            </div>
                            <div class="part-item">
                                <div class="item-num">5</div>
                                <div class="item-name">Neuroticism</div>
                                <div class="item-spec">${character.radar_metrics.neuroticism}/5</div>
                            </div>
                            <div class="part-item">
                                <div class="item-num">6</div>
                                <div class="item-name">Logic</div>
                                <div class="item-spec">${character.radar_metrics.logic}/5</div>
                            </div>
                        </div>
                        
                        <div class="list-section">
                            <div class="section-title">Components 7–11</div>
                            <div class="part-item">
                                <div class="item-num">7</div>
                                <div class="item-name">Empathy</div>
                                <div class="item-spec">${character.radar_metrics.empathy}/5</div>
                            </div>
                            <div class="part-item">
                                <div class="item-num">8</div>
                                <div class="item-name">Authority</div>
                                <div class="item-spec">${character.radar_metrics.authority}/5</div>
                            </div>
                            <div class="part-item">
                                <div class="item-num">9</div>
                                <div class="item-name">Risk</div>
                                <div class="item-spec">${character.radar_metrics.risk}/5</div>
                            </div>
                            <div class="part-item">
                                <div class="item-num">10</div>
                                <div class="item-name">Uncertainty</div>
                                <div class="item-spec">${character.radar_metrics.uncertainty}/5</div>
                            </div>
                            <div class="part-item">
                                <div class="item-num">11</div>
                                <div class="item-name">Decisiveness</div>
                                <div class="item-spec">${character.radar_metrics.decisiveness}/5</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="spec-table">
                        <div class="spec-title">Performance Specifications</div>
                        <div class="spec-row">
                            <div class="spec-label">Ethical Awareness</div>
                            <div class="spec-value">${(character.ethical_awareness_score * 100).toFixed(1)}%</div>
                        </div>
                        <div class="spec-row">
                            <div class="spec-label">Ethical Action</div>
                            <div class="spec-value">${(character.ethical_action_score * 100).toFixed(1)}%</div>
                        </div>
                        <div class="spec-row">
                            <div class="spec-label">System Impact</div>
                            <div class="spec-value">${(character.impact_score * 100).toFixed(1)}%</div>
                        </div>
                        <div class="spec-row">
                            <div class="spec-label">Career Risk Tolerance</div>
                            <div class="spec-value">${(character.career_risk_taken * 100).toFixed(1)}%</div>
                        </div>
                    </div>
                    
                    <div class="spec-table">
                        <div class="spec-title">Service Notes</div>
                        <div style="font-size: 8pt; line-height: 1.6; padding-top: 8px;">
                            <div style="margin-bottom: 8px;"><strong>CORE DRIVE:</strong> ${character.core_drive}</div>
                            <div style="margin-bottom: 8px;"><strong>VULNERABILITY:</strong> ${character.vulnerability}</div>
                            <div><strong>OUTCOME:</strong> ${character.outcome}</div>
                        </div>
                    </div>
                    
                    <div class="manual-footer">
                        Tilth Investigation • Practitioner Assembly Reference • Series 2048
                    </div>
                </div>
            `;
        }
        
        // Render all manual pages
        const container = document.getElementById('manualContainer');
        feedLoopCharacters.forEach(character => {
            container.innerHTML += renderPartsManual(character);
        });
    </script>
</body>
</html>
